"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.resolveRegionConfig = void 0;
var _getRealRegion = require("./getRealRegion");
var _isFipsRegion = require("./isFipsRegion");
const resolveRegionConfig = input => {
  const {
    region,
    useFipsEndpoint
  } = input;
  if (!region) {
    throw new Error("Region is missing");
  }
  return {
    ...input,
    region: async () => {
      if (typeof region === "string") {
        return (0, _getRealRegion.getRealRegion)(region);
      }
      const providedRegion = await region();
      return (0, _getRealRegion.getRealRegion)(providedRegion);
    },
    useFipsEndpoint: async () => {
      const providedRegion = typeof region === "string" ? region : await region();
      if ((0, _isFipsRegion.isFipsRegion)(providedRegion)) {
        return true;
      }
      return typeof useFipsEndpoint !== "function" ? Promise.resolve(!!useFipsEndpoint) : useFipsEndpoint();
    }
  };
};
exports.resolveRegionConfig = resolveRegionConfig;